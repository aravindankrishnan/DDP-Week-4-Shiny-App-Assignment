---
title: "DDP Week 4 Shiny App"
author: "Aravindan Krishnan"
date: "9/10/2018"
output: ioslides_presentation
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(shiny)
library(ggplot2)
library(dplyr)
library(tools)
library(DT)
data("mtcars")
```

## Shiny Presentation Overview

This R Markdown presentation is made interactive using Shiny. The viewers of the presentation can change the assumptions underlying what's presented and see the results immediately. 

The App demonstrated in this section is a simple interactive way to view scatter plots between variables within the "mtcars" dataset. The user can select the two variables to be plotted and the variable that can be used to color the data points. Based on this the app will display in the 'plot' tab, the correct plot that corresponds to the variables selected.

## Run through of App

- View "Instructions" Tab to learn how to use the App. Scroll down as needed.
- Enter Selection Parameters
- View "Data"" Tab to view the "mtcars" dataset that is being used in this App
- View "Plot" Tab to check the Interactive Scatter Plot that is generated by the Selection scriterion

## Interactive Plot

```{r shinyapp}
shinyApp(
ui <- fluidPage(
  titlePanel("Exploratory Plots for mtcars dataset"),
  sidebarLayout(
    sidebarPanel(
      selectInput(inputId = "Y",
                  label = "Y-Axis",
                  choices = c("Mileage"="mpg","Horsepower"="hp","Weight"="wt"),
                  selected = "mpg"),
      selectInput(inputId = "X",
                  label = "X-Axis",
                  choices = c("Mileage"="mpg","Horsepower"="hp","Weight"="wt"),
                  selected = "wt"),
      selectInput(inputId = "Z",
                  label = "Color by",
                  choices = c("Cylinder"="cyl","Transmision Type"="am","Displacement"="disp"),
                  selected = "am"),
      # Enter Text for Plot Title
      textInput(inputId = "plot_title",
                label = " Plot Title",
                placeholder = "Enter text for Plot Title")
      # Select Auto or Manual Gear Transmission for plot analysis
      #checkboxGroupInput(inputId = "transmision_type",
                         #label = "Select Type of Transmission",
                         #choices = c(0,1),
                         #selected = 0)
    ),
    # Output
    mainPanel(
      tabsetPanel(type="tabs",
                  tabPanel("Instructions",
                           h3("How to use this App"),
                           br(),
                           h4("Introduction"),
                           p("This Shiny App is used to review the relationship between
                             a set of variables that are part of the mtcars dataset. 
                             A scatter plot is created between a given pair of variables 
                             in the mtcars data set. The points are further color coded 
                             based on a third variable."),
                           hr(),
                           h4("Selection Screen"),
                           #br(),
                           h5("Y-Axis:"),
                           p("Select from the drop down the variable you want to use as 
                             Y-Axis in the Scatter Plot"),
                           #br(),
                           h5("X-Axis:"),
                           p("Select from the drop down the variable you want to use as 
                             X-Axis in the Scatter Plot"),
                           #br()
                           h5("Color by:"),
                           p("Select from the drop down the variable you want to use to color
                             code the scatter plot"),
                            
                           h5("Plot Title:"),
                           p("Enter the Title you want to keep for this Plot"),
                           hr(),
                           h4("To view the mtcars data"),
                           p("Go to 'Data' Tab to get a sneak peek of the mtcars data"),
                           hr(),
                           h4(" To view the Plot"),
                           p("Go to the 'Plot' tab to view the scatter plot generated based on the 
                              above selection parameters.")
                  ),
                  tabPanel("Data",
                           h4("The mtcars dataset"),
                           p("The data was extracted from the 1974 Motor Trend US magazine, 
                              and comprises fuel consumption and 10 aspects of 
                              automobile design and performance for 
                              32 automobiles (1973 to 1974 models)."),
                              br(),                              
                              p("Below is shown the first 6 rows of mtcars dataset. 
                             The variables are the various columns of the table.
                             The selection screen fields show a drop down of a select list 
                             of variables from which we choose the axes and the color coding variable."),
                           DT::dataTableOutput(outputId = "mtcars_data")),
                  tabPanel("Plot",
                          plotOutput(outputId = "scatterplot"),
                          textOutput(outputId = "description"))
      )
    )
  )
),
server <- function(input,output){
  # Create a subset of data filtering for transmission type
  mtcars$am <- as.factor(mtcars$am)
  mtcars$cyl <- as.factor(mtcars$cyl)
  output$mtcars_data <- renderDataTable({head(mtcars)})
  pretty_plot_title <- reactive({input$plot_title})
  
  # Create scatterplot for selected data
  output$scatterplot <- renderPlot({
    ggplot(data = mtcars,aes_string(x=input$X,y=input$Y,color = input$Z))+
      geom_point()+
      labs(title=pretty_plot_title())
  })
  # Create descritive text
  output$description <- renderText({
    paste0("The Plot above titled ",pretty_plot_title()," visualises the relationship between ",
           input$X, " and ",input$Y)
  })
},
 options = list(height = 500)
)
```



## Conclusion

The App has been successfully demonstrated. Leave a Feedback and i will try to improve the app.

Thanks for your participation in this Demo.


